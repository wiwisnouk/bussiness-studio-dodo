<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>–°—Ç—Ä–∞–Ω–∏—Ü–∞ —Å –æ–ø–ª–∞—Ç–æ–π</title>
    <style>
        /* –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –±–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤ 1.15 —Ä–∞–∑–∞ */
        html {
            font-size: 115%;
            transform: scale(1.15);
            transform-origin: 0 0;
            width: 86.9565%; /* 100% / 1.15 */
        }

        body {
            font-family: Inter, system-ui, sans-serif;
            margin: 0;
            padding: 23px; /* 20px * 1.15 */
            display: flex;
            justify-content: space-between;
            gap: 46px; /* 40px * 1.15 */
        }

        .main-content {
            flex: 1;
            max-width: 690px; /* 600px * 1.15 */
            margin-left: 115px; /* 100px * 1.15 */
        }

        .order-summary {
            width: 287.5px; /* 250px * 1.15 */
            background-color: #f9f9f9;
            border-radius: 13.8px; /* 12px * 1.15 */
            padding: 17.25px; /* 15px * 1.15 */
            box-shadow: 0 4.6px 13.8px rgba(0, 0, 0, 0.1); /* 4px * 1.15, 12px * 1.15 */
            display: flex;
            flex-direction: column;
            margin-right: 23px; /* 20px * 1.15 */
        }

        .order-title {
            font-size: 20.7px; /* 18px * 1.15 */
            font-weight: 700;
            margin-bottom: 17.25px; /* 15px * 1.15 */
            color: #333;
        }

        .order-details {
            margin-bottom: 10px; /* 20px * 1.15 */
        }

        .order-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 11.5px; /* 10px * 1.15 */
            padding-bottom: 11.5px; /* 10px * 1.15 */
            border-bottom: 1px solid #eee;
            font-size: 16.1px; /* 14px * 1.15 */
        }

        .order-row.total {
            font-weight: 700;
            border-bottom: none;
            font-size: 18.4px; /* 16px * 1.15 */
            margin-top: auto;
            padding-top: 17.25px; /* 15px * 1.15 */
            border-top: 2px solid #ddd;
        }

        .cards-container {
            margin-bottom: 10px; /* 20px * 1.15 */
        }

        .cards-title {
            font-size: 18.4px; /* 16px * 1.15 */
            font-weight: 600;
            margin-bottom: 13.8px; /* 12px * 1.15 */
        }

        .cards-carousel {
            position: relative;
            overflow: hidden;
            height: 280px; /* 220px * 1.15 */
        }

        .cards-wrapper {
            display: flex;
            transition: transform 0.3s ease;
        }

        .card {
            min-width: calc(42%);
            background: white;
            border-radius: 9.2px; /* 8px * 1.15 */
            padding: 11.5px; /* 10px * 1.15 */
            box-shadow: 0 2.3px 6.9px rgba(0, 0, 0, 0.1); /* 2px * 1.15, 6px * 1.15 */
            position: relative;
            height: 218.5px; /* 190px * 1.15 */
            display: flex;
            flex-direction: column;
        }

        .card-image {
            width: 100%;
            height: 115px; /* 100px * 1.15 */
            object-fit: cover;
            border-radius: 6.9px; /* 6px * 1.15 */
            margin-bottom: 6.9px; /* 6px * 1.15 */
        }

        .card-title {
            font-weight: 600;
            margin-bottom: 4.6px; /* 4px * 1.15 */
            font-size: 14.95px; /* 13px * 1.15 */
        }

        .card-price {
            color: #FF5D01;
            font-weight: 600;
            margin-bottom: 3.45px; /* 3px * 1.15 */
            font-size: 14.95px; /* 13px * 1.15 */
        }

        .card-delivery {
            font-size: 12.65px; /* 11px * 1.15 */
            color: #666;
            margin-bottom: 9.2px; /* 8px * 1.15 */
        }

        .add-button {
            position: absolute;
            bottom: 11.5px; /* 10px * 1.15 */
            right: 11.5px; /* 10px * 1.15 */
            background-color: #FF5D01;
            color: white;
            border: none;
            border-radius: 6.9px; /* 6px * 1.15 - –∏–∑–º–µ–Ω–µ–Ω–æ —Å –∫—Ä—É–≥–ª–æ–π –Ω–∞ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω—É—é */
            width: 40px; /* –£–≤–µ–ª–∏—á–µ–Ω–∞ —à–∏—Ä–∏–Ω–∞ */
            height: 32.2px; /* 28px * 1.15 */
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 16.1px; /* 14px * 1.15 */
            font-weight: bold;
            z-index: 10; /* –£–≤–µ–ª–∏—á–µ–Ω–æ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏—è */
        }

        .add-button:hover {
            background-color: #e65100;
        }

        .remove-button {
            position: absolute;
            bottom: 11.5px; /* 10px * 1.15 */
            right: 63px; /* –°–¥–≤–∏–Ω—É—Ç–æ –≤–ø—Ä–∞–≤–æ –∏–∑-–∑–∞ —É–≤–µ–ª–∏—á–µ–Ω–Ω–æ–π –∫–Ω–æ–ø–∫–∏ + */
            background-color: #666;
            color: white;
            border: none;
            border-radius: 6.9px; /* 6px * 1.15 - –∏–∑–º–µ–Ω–µ–Ω–æ —Å –∫—Ä—É–≥–ª–æ–π –Ω–∞ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω—É—é */
            width: 32px; /* –£–≤–µ–ª–∏—á–µ–Ω–∞ —à–∏—Ä–∏–Ω–∞ */
            height: 32px; /* 20px * 1.15 */
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 16.1px; /* 14px * 1.15 */
            font-weight: bold;
            z-index: 10; /* –£–≤–µ–ª–∏—á–µ–Ω–æ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏—è */
        }

        .remove-button:hover {
            background-color: #555;
        }

        .counter {
            position: absolute;
            bottom: 11.5px; /* 10px * 1.15 */
            right: 107px; /* –°–¥–≤–∏–Ω—É—Ç–æ –≤–ø—Ä–∞–≤–æ –∏–∑-–∑–∞ —É–≤–µ–ª–∏—á–µ–Ω–Ω—ã—Ö –∫–Ω–æ–ø–æ–∫ */
            background-color: #FF5D01;
            color: white;
            border-radius: 50%;
            width: 26px; /* –£–≤–µ–ª–∏—á–µ–Ω–æ */
            height: 26px; /* –£–≤–µ–ª–∏—á–µ–Ω–æ */
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12.65px; /* 11px * 1.15 */
            font-weight: bold;
            z-index: 10; /* –£–≤–µ–ª–∏—á–µ–Ω–æ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏—è */
        }

        /* –ë–µ–π–¥–∂ "–î–æ–¥–æ –º–∞–Ω–∏—è" */
        .dodo-mania-badge {
            position: absolute;
            bottom: 11.5px; /* 10px * 1.15 */
            left: 11.5px; /* 10px * 1.15 */
            background-color: transparent;
            color: #8A2BE2; /* –§–∏–æ–ª–µ—Ç–æ–≤—ã–π —Ü–≤–µ—Ç */
            border: 2px solid #8A2BE2; /* –§–∏–æ–ª–µ—Ç–æ–≤–∞—è –æ–±–≤–æ–¥–∫–∞ */
            border-radius: 17.25px; /* 15px * 1.15 - –∫—Ä—É–≥–ª—ã–µ —É–≥–ª—ã */
            padding: 3.45px 8.05px; /* 3px * 1.15, 7px * 1.15 */
            font-size: 11.5px; /* 10px * 1.15 */
            font-weight: 600;
            white-space: nowrap;
            z-index: 5;
            cursor: help;
            transition: all 0.2s ease;
        }

        .dodo-mania-badge:hover {
            background-color: rgba(138, 43, 226, 0.1);
        }

        /* –¢—É–ª—É–ø –¥–ª—è –±–µ–π–¥–∂–∞ */
        .dodo-mania-tooltip {
            position: absolute;
            bottom: 50px; /* –ü–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä—É–µ–º –≤—ã—à–µ –±–µ–π–¥–∂–∞ */
            left: 0;
            background-color: white;
            border: 2px solid #8A2BE2;
            border-radius: 9.2px; /* 8px * 1.15 */
            padding: 11.5px; /* 10px * 1.15 */
            width: 230px; /* –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —à–∏—Ä–∏–Ω–∞ */
            box-shadow: 0 4.6px 13.8px rgba(0, 0, 0, 0.15);
            font-size: 12.65px; /* 11px * 1.15 */
            line-height: 1.4;
            color: #333;
            z-index: 20;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .dodo-mania-badge:hover + .dodo-mania-tooltip {
            opacity: 1;
            visibility: visible;
        }

        .tooltip-link {
            color: #FF5D01;
            text-decoration: underline;
            font-weight: 600;
            cursor: pointer;
            transition: color 0.2s ease;
        }

        .tooltip-link:hover {
            color: #e65100;
        }

        .carousel-controls {
            display: flex;
            justify-content: center;
            margin-top: 11.5px; /* 10px * 1.15 */
        }

        .carousel-dot {
            width: 6.9px; /* 6px * 1.15 */
            height: 6.9px; /* 6px * 1.15 */
            border-radius: 50%;
            background-color: #ddd;
            margin: 0 4.6px; /* 4px * 1.15 */
            cursor: pointer;
        }

        .carousel-dot.active {
            background-color: #FF5D01;
        }

        .carousel-arrow {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background-color: #FF5D01;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 18px;
            font-weight: bold;
            border: none;
            transition: background-color 0.3s;
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            z-index: 10;
        }

        .carousel-arrow:hover {
            background-color: #e65100;
        }

        .carousel-arrow.prev {
            left: 5px;
        }

        .carousel-arrow.next {
            right: 5px;
        }

        .logo_dodo {
            display: flex;
            align-items: center;
            gap: 11.5px; /* 10px * 1.15 */
            margin-bottom: 23px; /* 20px * 1.15 */
            position: relative;
        }

        h1 {
            font-size: 34.5px; /* 30px * 1.15 */
            line-height: 32.2px; /* 28px * 1.15 */
            font-weight: 700;
            margin: 0;
        }

        .network-info {
            font-size: 13.8px; /* 12px * 1.15 */
            color: #666;
            position: absolute;
            top: -40px; /* –ü–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä—É–µ–º –Ω–∞–¥ –ª–æ–≥–æ—Ç–∏–ø–æ–º */
            left: 60px; /* –°–¥–≤–∏–≥–∞–µ–º –≤–ø—Ä–∞–≤–æ –æ—Ç –ª–æ–≥–æ—Ç–∏–ø–∞ */
            white-space: nowrap;
        }

        .network-highlight {
            color: #FF5D01;
            position: absolute;
            top: -20px; /* –ü–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä—É–µ–º –ø–æ–¥ –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–æ–π */
            left: 60px; /* –°–¥–≤–∏–≥–∞–µ–º –≤–ø—Ä–∞–≤–æ –æ—Ç –ª–æ–≥–æ—Ç–∏–ø–∞ */
            white-space: nowrap;
        }

        h2 {
            font-size: 27.6px; /* 24px * 1.15 */
            line-height: 32.2px; /* 28px * 1.15 */
            font-weight: 700;
            margin-bottom: 23px; /* 20px * 1.15 */
        }

        .form-group {
            margin-bottom: 23px; /* 20px * 1.15 */
        }

        label {
            display: block;
            margin-bottom: 5.75px; /* 5px * 1.15 */
            font-size: 16.1px; /* 14px * 1.15 */
        }

        input {
            width: 100%;
            padding: 11.5px; /* 10px * 1.15 */
            border: 1px solid #ddd;
            border-radius: 6.9px; /* 6px * 1.15 */
            font-size: 16.1px; /* 14px * 1.15 */
            box-sizing: border-box;
        }

        .order-button {
            background-color: #FF5D01;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 15px 1px;
            text-align: center;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            width: 100%;
            margin-top: 20px;
            transition: background-color 0.3s;
        }

        .order-button:hover {
            background-color: #e65100;
        }

        .order-button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }

    </style>
</head>
<body>
    <div class="main-content">
        <div class="logo_dodo" style="display: flex; align-items: center; gap: 10px;">

            <h1 style="font-family: Inter, system-ui, sans-serif; font-size: 30px; line-height: 28px; font-weight: 700;">
                <img
                        src="https://png.klev.club/uploads/posts/2024-04/png-klev-club-6kxo-p-logotip-dodo-pitstsa-png-12.png"
                        alt="–õ–æ–≥–æ—Ç–∏–ø –î–æ–¥–æ"
                        width="50"
                        style="vertical-align: middle;"
                >
                –î–æ–¥–æ –ü–∏—Ü—Ü–∞
            </h1>

            <p style="font-family: Inter, system-ui, sans-serif; font-size: 12px; color: #666; margin-top: 5px; position: relative; left: -190px">
                <br><br><br><br>–°–µ—Ç—å ‚Ññ1 –≤ –†–æ—Å—Å–∏–∏<br>
            </p>

            <p style="font-family: Inter, system-ui, sans-serif; font-size: 12px; color: #666; margin-top: 5px; color: #FF5D01; position: relative; left: -303px">
                <br><br><br><br><br><br>–ø–æ &nbsp;–∫–æ–ª–∏—á–µ—Å—Ç–≤—É –ø–∏—Ü—Ü–µ—Ä–∏–π
            </p>
        </div>

        <h2>–ó–∞–∫–∞–∑ –Ω–∞ –¥–æ—Å—Ç–∞–≤–∫—É</h2>

            <div class="form-group">
                <label>–ò–º—è</label>
                <input type="text" name="username" id="username">
            </div>

            <div class="form-group">
                <label>–ù–æ–º–µ—Ä –¢–µ–ª–µ—Ñ–æ–Ω–∞</label>
                <input type="tel" placeholder="+7 999 999-99-99" value="+7 (987) 999-99-99">
            </div>

            <div class="form-group">
                <label>–ê–¥—Ä–µ—Å –î–æ—Å—Ç–∞–≤–∫–∏</label>
                <input type="text" placeholder="–ì–∞—à–µ–∫–∞ 7" value="–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –£–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç">
            </div>
    </div>

    <div class="order-summary">
        <div class="order-title">–°–æ—Å—Ç–∞–≤ –∑–∞–∫–∞–∑–∞</div>

        <div class="order-details">
            <!-- –û—Å–Ω–æ–≤–Ω–∞—è –ø–∏—Ü—Ü–∞ - —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è -->
            <div class="order-row">
                <span>{{ main_pizza.title }}</span>
                <span>{{ main_pizza.price }} ‚ÇΩ</span>
            </div>

            <!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –∑–¥–µ—Å—å —á–µ—Ä–µ–∑ JS -->
            <div id="additional-items">
                <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ–º—ã–µ —Ç–æ–≤–∞—Ä—ã -->
            </div>

            <div class="order-row">
                <span>–°—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏</span>
                <span class="delivery-price">{{ cart_total.delivery_price }} ‚ÇΩ</span>
            </div>
        </div>

        <div class="cards-container">
            <div class="cards-title">–î–æ–±–∞–≤–∏—Ç—å –∫ –∑–∞–∫–∞–∑—É?</div>

            <div class="cards-carousel">
                <button class="carousel-arrow prev">‚Äπ</button>
                <div class="cards-wrapper" id="cardsWrapper">
                    <!-- –ö–∞—Ä—Ç–æ—á–∫–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
                </div>
                <button class="carousel-arrow next">‚Ä∫</button>
            </div>

            <div class="carousel-controls" id="carouselDots">
                <!-- –¢–æ—á–∫–∏ –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
            </div>
        </div>

        <div class="order-row total">
            <span>–ò—Ç–æ–≥–æ</span>
            <span>799 ‚ÇΩ</span>
        </div>

        <!-- –ö–Ω–æ–ø–∫–∞ –∑–∞–∫–∞–∑–∞—Ç—å -->
        <a
                href="/{{ pizza_id }}/final?total={{ cart_total.final_total }}"
                class="order-button"
                id="orderButton"
                onclick="this.href = this.href + '&username=' + encodeURIComponent(document.getElementById('username').value)"
        >

            –ó–∞–∫–∞–∑–∞—Ç—å!
        </a>

    </div>

    <script>
    const cards = [
        {
            id: 1,
            title: "–î–æ–¥—Å—Ç–µ—Ä",
            image: "https://media.dodostatic.net/image/r:584x584/01980cb92528769295aeb186fb501f8e.webp",
            price: 249,
            add_url: "/api/add_to_cart/1",
            remove_url: "/api/remove_from_cart/1"
        },
        {
            id: 2,
            title: "Rich Tea",
            image: "https://media.dodostatic.net/image/r:292x292/019a1089d33a7943a2c2c89e518c1341.webp",
            price: 159,
            add_url: "/api/add_to_cart/2",
            remove_url: "/api/remove_from_cart/2"
        },
        {
            id: 3,
            title: "–ö—Ä–µ–≤–µ—Ç–∫–∏",
            image: "https://media.dodostatic.net/image/r:292x292/0198556badcf772484ba8ef325c9f09f.webp",
            price: 379,
            add_url: "/api/add_to_cart/3",
            remove_url: "/api/remove_from_cart/3"
        },
        {
            id: 4,
            title: "–°–æ—É—Å —Å—ã—Ä–Ω—ã–π",
            image: "https://media.dodostatic.net/image/r:1875x1875/0197f86ac30a734eb384d710bb1789f3.webp",
            price: 49,
            add_url: "/api/add_to_cart/4",
            remove_url: "/api/remove_from_cart/4"
        },
        {
            id: 5,
            title: "–ü–∏—Ü—Ü–∞ + –ù–∞–ø–∏—Ç–æ–∫",
            image: "https://media.dodostatic.net/image/r:1875x1875/0197c001ff39748ea72e0da6db8b13f0.webp",
            price: 389,
            add_url: "/api/add_to_cart/5",
            remove_url: "/api/remove_from_cart/5"
        }
    ];

    const counters = Array(cards.length).fill(0);
    let currentCardIndex = 0;

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ—Ä–∑–∏–Ω—ã
    function updateCartDisplay(cartData) {
        console.log('=== –û–ë–ù–û–í–õ–ï–ù–ò–ï –ò–ù–¢–ï–†–§–ï–ô–°–ê –ö–û–†–ó–ò–ù–´ ===');
        console.log('–î–∞–Ω–Ω—ã–µ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞:', cartData);

        // –û–±–Ω–æ–≤–ª—è–µ–º –¥–æ—Å—Ç–∞–≤–∫—É
        const deliveryElement = document.querySelector('.delivery-price');
        if (deliveryElement) {
            deliveryElement.textContent = `${cartData.delivery_price} ‚ÇΩ`;
            console.log(`–î–æ—Å—Ç–∞–≤–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞: ${cartData.delivery_price} ‚ÇΩ`);
        }

        // –û–±–Ω–æ–≤–ª—è–µ–º –∏—Ç–æ–≥–æ–≤—É—é —Å—É–º–º—É
        const totalElement = document.querySelector('.order-row.total span:last-child');
        if (totalElement) {
            totalElement.textContent = `${cartData.final_total} ‚ÇΩ`;
            console.log(`–ò—Ç–æ–≥–æ–≤–∞—è —Å—É–º–º–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞: ${cartData.final_total} ‚ÇΩ`);
        }

        // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤
        updateItemsDisplay(cartData.items);
    }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∫–æ—Ä–∑–∏–Ω–µ
    function updateItemsDisplay(items) {
        const additionalItemsContainer = document.getElementById('additional-items');
        if (!additionalItemsContainer) {
            console.log('–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω');
            return;
        }

        // –û—á–∏—â–∞–µ–º —Ç–æ–ª—å–∫–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã (–Ω–µ –æ—Å–Ω–æ–≤–Ω—É—é –ø–∏—Ü—Ü—É)
        additionalItemsContainer.innerHTML = '';

        // –î–æ–±–∞–≤–ª—è–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã
        items.forEach((item, index) => {
            if (index > 0) { // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –æ—Å–Ω–æ–≤–Ω—É—é –ø–∏—Ü—Ü—É (–ø–µ—Ä–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç)
                const itemElement = document.createElement('div');
                itemElement.className = 'order-row additional-item';
                itemElement.innerHTML = `
                    <span>${item.name} √ó ${item.quantity}</span>
                    <span>${item.total} ‚ÇΩ</span>
                `;
                additionalItemsContainer.appendChild(itemElement);
                console.log(`–î–æ–±–∞–≤–ª–µ–Ω —Ç–æ–≤–∞—Ä –≤ –∫–æ—Ä–∑–∏–Ω—É: ${item.name} - ${item.total} ‚ÇΩ`);
            }
        });
    }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ –¥–æ—Å—Ç–∞–≤–∫–∏
    async function getDeliveryTextWithMainPizza(productPrice, productId) {
        try {
            const response = await fetch(`/api/calculate_delivery_for_product/${productId}`);
            if (response.ok) {
                const data = await response.json();
                console.log(`–†–∞—Å—á–µ—Ç –¥–æ—Å—Ç–∞–≤–∫–∏ –¥–ª—è —Ç–æ–≤–∞—Ä–∞ ${productId}:`, data);

                if (data.delivery_with_product === 0) {
                    return "üöö –ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞!";
                } else {
                    return `üöö ${data.current_delivery} -> ${data.delivery_with_product}`;
                }
            }
        } catch (error) {
            console.error('Error calculating delivery:', error);
        }
        return "–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –¥–æ—Å—Ç–∞–≤–∫—É";
    }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∞–∫—Ç—É–∞–ª—å–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–æ—Ä–∑–∏–Ω—ã
    async function fetchCartTotal() {
        try {
            console.log('–ó–∞–ø—Ä–æ—Å –∞–∫—Ç—É–∞–ª—å–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–æ—Ä–∑–∏–Ω—ã...');
            const response = await fetch('/api/cart_total');
            if (response.ok) {
                const cartData = await response.json();
                updateCartDisplay(cartData);
            } else {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–æ—Ä–∑–∏–Ω—ã');
            }
        } catch (error) {
            console.error('Error fetching cart total:', error);
        }
    }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
    async function addToCart(productId, addUrl) {
        console.log(`=== –ü–û–ü–´–¢–ö–ê –î–û–ë–ê–í–ò–¢–¨ –¢–û–í–ê–† ${productId} ===`);

        try {
            const response = await fetch(addUrl, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    product_id: productId,
                    quantity: 1
                })
            });

            if (response.ok) {
                const result = await response.json();
                console.log('–¢–æ–≤–∞—Ä —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω:', result);

                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫
                const index = cards.findIndex(card => card.id === productId);
                if (index !== -1) {
                    counters[index] = result.quantity;
                    console.log(`–°—á–µ—Ç—á–∏–∫ —Ç–æ–≤–∞—Ä–∞ ${productId} –æ–±–Ω–æ–≤–ª–µ–Ω: ${counters[index]}`);
                }

                updateCartDisplay(result.cart_total);
                await renderCards();
            } else {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —Ç–æ–≤–∞—Ä–∞');
            }
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏:', error);
        }
    }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
    async function removeFromCart(productId, removeUrl) {
        console.log(`=== –ü–û–ü–´–¢–ö–ê –£–î–ê–õ–ò–¢–¨ –¢–û–í–ê–† ${productId} ===`);

        try {
            const response = await fetch(removeUrl, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    product_id: productId,
                    quantity: 1
                })
            });

            if (response.ok) {
                const result = await response.json();
                console.log('–¢–æ–≤–∞—Ä —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω:', result);

                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫
                const index = cards.findIndex(card => card.id === productId);
                if (index !== -1) {
                    counters[index] = result.quantity;
                    console.log(`–°—á–µ—Ç—á–∏–∫ —Ç–æ–≤–∞—Ä–∞ ${productId} –æ–±–Ω–æ–≤–ª–µ–Ω: ${counters[index]}`);
                }

                updateCartDisplay(result.cart_total);
                await renderCards();
            } else {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Ç–æ–≤–∞—Ä–∞');
            }
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏:', error);
        }
    }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ –∫–∞—Ä—Ç–æ—á–µ–∫
    async function renderCards() {
        console.log('–û—Ç—Ä–∏—Å–æ–≤–∫–∞ –∫–∞—Ä—Ç–æ—á–µ–∫...');

        const cardsWrapper = document.getElementById('cardsWrapper');
        const carouselDots = document.getElementById('carouselDots');

        if (!cardsWrapper) {
            console.error('–≠–ª–µ–º–µ–Ω—Ç cardsWrapper –Ω–µ –Ω–∞–π–¥–µ–Ω!');
            return;
        }

        cardsWrapper.innerHTML = '';
        carouselDots.innerHTML = '';

        // –°–æ–∑–¥–∞–µ–º –∫–∞—Ä—Ç–æ—á–∫–∏
        for (let index = 0; index < cards.length; index++) {
            const card = cards[index];
            const cardElement = document.createElement('div');
            cardElement.className = 'card';

            const deliveryText = await getDeliveryTextWithMainPizza(card.price, card.id);

            cardElement.innerHTML = `
                <img src="${card.image}" alt="${card.title}" class="card-image">
                <div class="card-title">${card.title}</div>
                <div class="card-price">${card.price} ‚ÇΩ</div>
                <div class="card-delivery">${deliveryText}</div>
                <div class="dodo-mania-badge">–î–æ–¥–æ–ú–∞–Ω–∏—è</div>
                <div class="dodo-mania-tooltip">
                    –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —Ç–æ–≤–∞—Ä–∞, –≤—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—á–∞—Å—Ç–≤—É–µ—Ç–µ –≤ —Ä–æ–∑—ã–≥—Ä—ã—à–µ, –≤—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —Ç—É—Ç:
                    <span class="tooltip-link" onclick="window.open('https://dodopizza.ru/promotions', '_blank')">–¢—ã–∫</span>
                </div>
                <button class="add-button" data-product-id="${card.id}" data-add-url="${card.add_url}">+</button>
                ${counters[index] > 0 ? `
                    <button class="remove-button" data-product-id="${card.id}" data-remove-url="${card.remove_url}">-</button>
                    <div class="counter">${counters[index]}</div>
                ` : ''}
            `;

            cardsWrapper.appendChild(cardElement);
        }

        // –î–æ–±–∞–≤–ª—è–µ–º —Ç–æ—á–∫–∏ –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
        for (let i = 0; i < cards.length; i++) {
            const dot = document.createElement('div');
            dot.className = `carousel-dot ${i === currentCardIndex ? 'active' : ''}`;
            dot.dataset.index = i;
            carouselDots.appendChild(dot);

            dot.addEventListener('click', () => {
                currentCardIndex = i;
                updateCarousel();
            });
        }

        updateCarousel();
        console.log('–ö–∞—Ä—Ç–æ—á–∫–∏ –æ—Ç—Ä–∏—Å–æ–≤–∞–Ω—ã');

        // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫
        document.querySelectorAll('.add-button').forEach(button => {
            button.addEventListener('click', function() {
                const productId = parseInt(this.dataset.productId);
                const addUrl = this.dataset.addUrl;
                addToCart(productId, addUrl);
            });
        });

        document.querySelectorAll('.remove-button').forEach(button => {
            button.addEventListener('click', function() {
                const productId = parseInt(this.dataset.productId);
                const removeUrl = this.dataset.removeUrl;
                removeFromCart(productId, removeUrl);
            });
        });

        // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è —Å—Å—ã–ª–∫–∏ –≤ —Ç—É–ª—Ç–∏–ø–µ
        document.querySelectorAll('.tooltip-link').forEach(link => {
            link.addEventListener('click', function(e) {
                e.stopPropagation();
                window.open('https://dodopizza.ru/promotions', '_blank');
            });
        });
    }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–∞—Ä—É—Å–µ–ª–∏
    function updateCarousel() {
        const cardsWrapper = document.getElementById('cardsWrapper');
        const dots = document.querySelectorAll('.carousel-dot');

        if (cardsWrapper) {
            cardsWrapper.style.transform = `translateX(-${currentCardIndex * 100}%)`;
        }

        dots.forEach((dot, index) => {
            dot.classList.toggle('active', index === currentCardIndex);
        });
    }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ —Å–ª–µ–¥—É—é—â–µ–π –∫–∞—Ä—Ç–æ—á–∫–µ
    function nextCard() {
        currentCardIndex = (currentCardIndex + 1) % cards.length;
        updateCarousel();
    }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –∫–∞—Ä—Ç–æ—á–∫–µ
    function prevCard() {
        currentCardIndex = (currentCardIndex - 1 + cards.length) % cards.length;
        updateCarousel();
    }

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    document.addEventListener('DOMContentLoaded', function() {
        console.log('=== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –°–¢–†–ê–ù–ò–¶–´ ===');
        renderCards();
        fetchCartTotal();

        // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è —Å—Ç—Ä–µ–ª–æ–∫
        document.querySelector('.carousel-arrow.prev').addEventListener('click', prevCard);
        document.querySelector('.carousel-arrow.next').addEventListener('click', nextCard);

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
        document.addEventListener('keydown', function(e) {
            if (e.key === 'ArrowLeft') {
                prevCard();
            } else if (e.key === 'ArrowRight') {
                nextCard();
            }
        });
    });
</script>
</body>
</html>